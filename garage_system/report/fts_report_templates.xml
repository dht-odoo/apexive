<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <template id="report_payments_invoice">
        <t t-call="web.html_container">
            <t t-call="web.basic_layout">
                <t t-foreach="docs" t-as="o">
                    <div class="page">
                        <style>
                            .borderless td, .borderless th {
                                border: 1px solid white;
                                font-size: 8px;
                            }
                        </style>
                        <!-- Header -->
                        <div class="oe_structure">
                            <div class="container">
                                <div class="row" style="margin-left: 80px;">
                                    <div class="col-6">
                                        <div class="black" style="padding-top: 180px; padding-left: 50px; font-size: 15px; font-weight: 900;">
                                            <tr>
                                                <td>
                                                    <strong><p><t t-esc="o.invoice_date" t-options='{"widget": "date","format": "dd-MM-yyyy"}'/></p></strong>
                                                </td>
                                                <td>
                                                    <strong><p><t t-esc="o.fleet_id.license_plate"/></p></strong>
                                                </td>
                                                <td>
                                                    <strong><p><t t-esc="o.fleet_id.model_id.name"/></p></strong>
                                                </td>
                                                <td>
                                                    <span style='padding-left: 35px;'>
                                                        <strong><t t-esc="o.partner_id.name"/></strong>
                                                    </span>
                                                </td>
                                            </tr>
                                        </div>
                                        <tr>
                                            <td> 
                                                <p style="position: absolute; top: 325px;">
                                                    <strong>TRN:</strong>
                                                    <strong><span style="padding-left: 48px; font-size: 15px; font-weight: 900;"><t t-esc="o.partner_id.vat"/></span></strong>
                                                </p>
                                            </td>
                                        </tr>
                                    </div>
                                    <div class="col-3">
                                        <td>
                                            <div class="black" style="padding-top: 195px; font-size: 35px; font-weight: 900;">
                                                <strong>
                                                    <t t-if="o.fts_payment_type" t-esc="o.fts_payment_type.upper()"/>
                                                </strong>
                                            </div>
                                        </td>
                                    </div>
                                    <div class="col-3">
                                        <div class="black" style="padding-left: 15px; padding-top: 177px; font-size: 15px; font-weight: 900;">
                                            <tr>
                                                <td>
                                                    <strong><p class="text-end"><t t-esc="o.name"/></p></strong>
                                                </td>
                                                <td>
                                                    <strong><p><span style='padding-left: 115px;'><t t-esc="o.job_card_id.name"/></span></p></strong>
                                                </td>
                                                <td>
                                                    <strong><span><p style='padding-left: 115px;'><t t-esc="o.fleet_id.model_year"/></p></span></strong>
                                                </td>
                                                <td>
                                                    <strong><p style='padding-left: 115px;'><t t-esc="o.fleet_id.odometer"/></p></strong>
                                                </td>
                                            </tr>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Boady -->
                            <t t-set="display_discount" t-value="any(l.discount for l in o.invoice_line_ids)"/>
                            <table class="o_main_table table borderless" name="invoice_line_table"
                                   style="width: 947px; position: absolute; top: 400px; margin-left: 18px;">
                                <tbody>
                                    <t t-set="current_subtotal" t-value="0"/>
                                    <t t-set="lines"
                                       t-value="o.invoice_line_ids.sorted(key=lambda l: (-l.sequence, l.date, l.move_name, -l.id), reverse=True)"/>

                                    <t t-set="total_qty" t-value="0"/>
                                    <t t-set="total_unit_price" t-value="0.0"/>
                                    <t t-set="total_disc" t-value="0.0"/>
                                    <t t-set="total_gross_amt" t-value="0.0"/>
                                    <t t-set="total_tax_per" t-value="0"/>
                                    <t t-set="total_tax_amount" t-value="0.0"/>
                                    <t t-set="total_net_amount" t-value="0.0"/>
                                    <t t-foreach="lines" t-as="line">
                                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal"
                                           groups="account.group_show_line_subtotals_tax_excluded"/>
                                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_total"
                                           groups="account.group_show_line_subtotals_tax_included"/>

                                        <tr t-att-class="'bg-200 fw-bold o_line_section' if line.display_type == 'line_section' else 'fst-italic o_line_note' if line.display_type == 'line_note' else ''">
                                            <div style=" height: 20px;">
                                                <t t-if="line.display_type == 'product'"
                                                   name="account_invoice_line_accountable">
                                                    <td class="pb-0" name="account_invoice_line_name" style="width: 660px; font-size: 13px; padding-left: 25px; font-weight: 900;">   
                                                        <strong><span t-field="line.name" t-options="{'widget': 'text'}"/></strong>
                                                    </td>
                                                    <td style="width: 99px;">
                                                        <span></span>
                                                    </td>
                                                    <td style="font-weight: 900; width: 85px; font-size: 13px;" class="pb-0 pe-3">
                                                        <strong><span t-esc="round(line.quantity)"/>
                                                        <t t-set="total_qty" t-value="total_qty + line.quantity"/></strong>
                                                    </td>
                                                    <td class="pb-0" 
                                                        style="font-weight: 900; padding-left: 0px; width: 75px; font-size: 13px;">
                                                        <strong><span  t-esc="'%.2f' % round(line.price_unit)"/>
                                                        <t t-set="total_unit_price"
                                                           t-value="total_unit_price + float(line.price_unit)"/></strong>
                                                    </td>
                                                    <td style="margin-left: 10px;">
                                                        <span></span>
                                                    </td>
                                                    <td class="pb-0"
                                                        style="font-weight: 900; width: 93px; font-size: 13px;">
                                                        <strong><span class=""  t-esc="'%.2f' % round(line.discount_amt)"/>
                                                        <t t-set="total_disc" t-value="total_disc + float(line.discount_amt)"/></strong>
                                                    </td>
                                                    <td class="pb-0" style="font-weight: 900; width: 70px; font-size: 13px;">
                                                        <strong><span class="text-nowrap"
                                                               t-esc="'%.2f' % round(line.price_subtotal)"/> <!--groups="account.group_show_line_subtotals_tax_excluded"-->
                                                        <t t-set="total_gross_amt"
                                                           t-value="total_gross_amt + float(line.price_subtotal)"/></strong>
                                                    </td>
                                                    <td>
                                                        <span></span>
                                                    </td>
                                                    <td class="text-end pb-0"
                                                        style="font-weight: 900; padding-left: 8px; width: 45px; font-size: 12px; padding-right: 0px;">
                                                        <strong><span t-esc="line.tax_ids.amount"
                                                              id="line_tax_ids"/></strong>
                                                        <t t-set="total_tax_per" t-value="0"/>
                                                    </td>
                                                    <td class="pb-0 text-end" style="font-weight: 900; width: 80px; font-size: 13px;">
                                                        <strong><span class="text-nowrap"  t-esc="'%.2f' % round(line.l10n_ae_vat_amount)"/></strong>
                                                        <t t-set="total_tax_amount"
                                                           t-value="total_tax_amount + float(line.l10n_ae_vat_amount)"/>
                                                    </td>
                                                    <td class="text-center pb-0" style="font-weight: 900; width: 155px; font-size: 13px;">
                                                        <strong><span class="text-nowrap"
                                                              t-esc="'%.2f' % round(line.price_total)"/></strong> <!--groups="account.group_show_line_subtotals_tax_included"-->
                                                        <t t-set="total_net_amount"
                                                           t-value="total_net_amount + float(line.price_total)"/>
                                                    </td>
                                                </t>
                                                <t t-if="line.display_type == 'line_section'">
                                                    <td class="pb-0" colspan="99">
                                                        <strong><span t-field="line.name" t-options="{'widget': 'text'}"/></strong>
                                                    </td>
                                                    <t t-set="current_section" t-value="line"/>
                                                    <t t-set="current_subtotal" t-value="0"/>
                                                </t>
                                                <t t-if="line.display_type == 'line_note'">
                                                    <td colspan="99">
                                                        <strong><span t-field="line.name" t-options="{'widget': 'text'}"/></strong>
                                                    </td>
                                                </t>
                                            </div>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                            <!-- Footer -->
                            <p style="page-break-after: always;"/>
                            <table class="o_main_table table borderless" name="invoice_total_table"
                                   style="width: 947px; position: absolute; top: 920px; margin-left: 15px;">
                                <tbody>
                                    <tr>
                                        <td style="width: 660px; font-size: 13px; font-weight: 900;">
                                            <strong><span style="padding-left: 40px;"></span></strong>
                                        </td>
                                        <td style="width: 99px;">
                                            <span>
                                            </span>
                                        </td>
                                        <td class="text-center pe-3" style="width: 85px; font-size: 13px; font-weight: 900;">
                                            <strong><t t-esc="'%.2f' % round(total_qty)"/><t t-options='{"widget": "monetary"}'/></strong>
                                        </td>
                                        <td class="" style="width: 75px; font-size: 13px; font-weight: 900;">
                                            <strong><t t-esc="'%.2f' % round(total_unit_price)"/></strong>
                                        </td>
                                        <td>
                                            <p>
                                                <strong><span></span></strong>
                                            </p>
                                        </td>
                                        <td class="" style="width: 93px; font-size: 13px; font-weight: 900;">
                                            <strong><t t-esc="'%.2f' % round(total_disc)"/><t t-options='{"widget": "monetary"}'/></strong>
                                        </td>
                                        <td class="text-end"  style="width: 70px; font-size: 13px; font-weight: 900;">
                                            <strong><t t-esc="'%.2f' % round(total_gross_amt)"/><t t-options='{"widget": "monetary"}'/></strong>
                                        </td>
                                        <td class="text-end"  style="width: 80px; font-size: 13px; font-weight: 900;">
                                            <p>
                                                <strong><span></span></strong>
                                            </p>
                                        </td>
                                        <td class="text-end"  style="width: 80px; font-size: 13px; font-weight: 900;">
                                            <p>
                                                <strong><t t-out="'%.2f' % round(total_tax_amount)"/><t t-options='{"widget": "monetary"}'/></strong>
                                            </p>
                                        </td>
                                        <td class="text-center"  style="width: 155px; font-size: 13px; font-weight: 900;">
                                            <strong><t t-esc="round(total_net_amount)"/><t t-options='{"widget": "monetary"}'/></strong>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="font-size: 13px; font-weight: 900; padding-left: 45px; padding-top: 0px;">
                                            <strong><p><t t-out="o.currency_id.amount_to_text(total_net_amount).replace(',', ' ')"/></p></strong>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="font-size: 13px; font-weight: 900; padding-left: 90px; padding-top: 41px;">
                                            <strong><p><t t-out="o.invoice_user_id.name"/></p></strong>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>